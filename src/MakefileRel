##propagation makefile

.SUFFIXES: .cc .class .java .cxx .C .cpp .O .c .l .y .f .f95
 
 
VPATH =  
 
YACC = bison
LEX = flex
JAVA = gcj
CC = gcc
CPP = g++
FORT = g77
YACC_FLAGS =
LEX_FLAGS =
JAVA_FLAGS =
CC_FLAGS =
CPP_FLAGS =   -O2 -Wall
YACC_INCLUDES =
LEX_INCLUDES =
JAVA_INCLUDES =
CC_INCLUDES =
CPP_INCLUDES = -I./3rd-party/include
YACC_DEFINES =
LEX_DEFINES =
JAVA_DEFINES =
CC_DEFINES =
CPP_DEFINES = -DUSE_GSL
propagation.sp_LIBS = -lc -lxerces-c -lgsl -lgslcblas -lgfortran
Xmax_LIBS = -lc -lgsl -lgslcblas
LINKER = g++
LINKER_FLAGS = -L./3rd-party/lib -L/lib
LINKER_ENTRY =

propagation.sp_OBJECTS = BLLac.O pp/pp.O pp/frag.O Galaxy.O Parameters.O Source.O RadioBackground.O GZK2.O Franceschini08EBL.O CustomCouplings.O Escape.O Inoue12IROSpectrum.O BlackHoleInjSpectra.O GammaSplitting.O Sarkar1005Background.O Kneiske0309IROSpectrum.O AA.O Weak.O TPP.O Synchrotron.O PP.O PhotoDisintegration.O NeutronDecay.O MPP.O Jacobian.O ICS.O Concentrations.O Coupling.O TableBackground.O Kneiske1001IROSpectrum.O Log.O ScanInfoWritter.O Resource.O base64.O VersionInfo.O Dpp.O ClusterIROSpectrum.O Stecker2005IROSpectrum.O Stecker98IROSpectrum.O Nucleus.O PowerLowInjectionSpectra.O ParticleList.O FragmentationBasedInjSpectra.O Function.O PropagEngine.O Addfunc.O Background.O const.O EMCrosssec.O DataReader.O main.O FilePreprocessor.O FilePtr.O Fragmentation.O InjectionSpectra.O LEPData.O TableFunc.O MassiveNeutrino.O MuPP.O ParticleData.O Ppp.O DecaySpectrum.O Medium.O Ranges.O SecondaryDifSigma.O Sigma.O TableReader.O TimeZ.O UserInjSpectra.O Vector.O Units.O Init.O KneiskeIROSpectrum.O PrimackIROSpectrum.O XMLUtil.O XMLSwitchFileReader.O

Xmax_OBJECTS = Xmax.O Log.O Addfunc.O FilePreprocessor.O FilePtr.O TableFunc.O TableReader.O Vector.O base64.O Resource.O VersionInfo.O

ResourceCompile_OBJECTS = base64.O ResourceCompile.O
 
all: propagation
VersionInfo: ResourceCompile
	./PrintInfo.sh

DeleteVersionInfo:
	rm -f _autogeneratedVersionInfo.h _autogeneratedDif.c _autogeneratedGitInfo.c

ResourceCompile: $(ResourceCompile_OBJECTS)
	g++ -o ResourceCompile $(LINKER_ENTRY) $(LINKER_FLAGS) $(ResourceCompile_OBJECTS) -lc

Xmax: VersionInfo $(Xmax_OBJECTS) DeleteVersionInfo
	$(LINKER) -o ../bin/Xmax $(LINKER_ENTRY) $(LINKER_FLAGS) $(Xmax_OBJECTS) $(Xmax_LIBS)

propagation: VersionInfo $(propagation.sp_OBJECTS) DeleteVersionInfo
	$(LINKER) -o ../bin/propagation $(LINKER_ENTRY) $(LINKER_FLAGS) $(propagation.sp_OBJECTS) $(propagation.sp_LIBS)

.y.c:
	$(YACC) $< $(YACC_FLAGS) $(YACC_DEFINES) $(YACC_INCLUDES)


.l.c:
	$(LEX) $< $(LEX_FLAGS) $(LEX_DEFINES) $(LEX_INCLUDES)


.java.O:
	$(JAVA) -c $< $(JAVA_FLAGS) $(JAVA_DEFINES) $(JAVA_INCLUDES) -o $@
.class:
	$(JAVA) -c $< $(JAVA_FLAGS) $(JAVA_DEFINES) $(JAVA_INCLUDES)


.c.O:
	$(CC) -c $< $(CC_FLAGS) $(CC_DEFINES) $(CC_INCLUDES) -o $@


.cpp.O:
	$(CPP) -c $< $(CPP_FLAGS) $(CPP_DEFINES) $(CPP_INCLUDES) -o $@
.C.O:
	$(CPP) -c $< $(CPP_FLAGS) $(CPP_DEFINES) $(CPP_INCLUDES) -o $@
.cc.O:
	$(CPP) -c $< $(CPP_FLAGS) $(CPP_DEFINES) $(CPP_INCLUDES) -o $@
.cxx.O:
	$(CPP) -c $< $(CPP_FLAGS) $(CPP_DEFINES) $(CPP_INCLUDES) -o $@

#.f.O:
#	$(FORT) -fno-second-underscore -ff2c -c $< -o $@
	
.f.O:
	gfortran -ffixed-line-length-200 -std=legacy -c $< -o $@

.f95.O:
	gfortran -ffixed-line-length-200 -std=legacy -c $< -o $@

clean: DeleteVersionInfo
	rm -f *.O pp/*.O
